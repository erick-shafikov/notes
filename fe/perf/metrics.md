# Метрики страницы

## FCP

first contentful paint (первая отрисовка) выделять критический css (главное метрика)

## LCP

- largest contentful paint - отрисовка самого большого элемента. Равен FCP без картинок и без критических стилей, выделять height и width для картинки. Убивают видео и фреймы. Можно вставить прямоугольник или картинку, но появляется потенциальная проблема оптимизации. Если проблема в картинке убрать lazy и добавить в preload или заменить на заголовок. Если текст - добавить шрифт в preload.

Показатели:

- Время: хорошо до 2.5 с. плохо - 4с.
- факторы влияния: время отклика сервера, код, блокирующий рендеринг,шрифты

## FID

время до того как элемент становится активным. Разбиение больших js задач на более мелкие. Или использовать css вместо js

- Время: хорошо - 100мс, плохо - 400
- Факторы влияния: объем js

## TTI

time to interactive

## CLS

Cumulative layout shift (сдвиг от первоначального) правильно выделять критический css. важно анимировать в CSS только функцией transform: translate()

- время: хорошо - 0.1 с, плохо = 0.25
- Факторы влияния: размеры картинок, загрузка банеров, резервирование места

## TBT

total blocking time – время, которое нужно для обработки первого действия пользователя

## TTFB

Time to First Byte

- размещать контент как можно ближе к пользователям географически
- кешировать контент для быстрого ответа при повторных запросах

## SI

speed index

!!! Браузер автоматически сокращает любое количество пробелов до одного
!!! больше 4гб не выделяется на вкладку

# INP

Interaction to Next Paint - Взаимодействие со следующей отрисовкой

- Факторы влияющие:
- - Оптимизация длительных задач:
- - - оптимальное использование библиотек
- - - dev-tools coverage tool
- - - code-splitting
- - Минимизация крупных обновлений рендеринга
- - - минимизация операций в DOM
- - - css для скрытого

# js сканирование аналитики

```js
import { getCLS, getFID, getLCP } from "web-vitals";

function sendToAnalytics(metric) {
  const body = JSON.stringify(metric);
  // Use `navigator.sendBeacon()` if available, falling back to `fetch()`.
  (navigator.sendBeacon && navigator.sendBeacon("/analytics", body)) ||
    fetch("/analytics", { body, method: "POST", keepalive: true });
}

getCLS(sendToAnalytics);
getFID(sendToAnalytics);
getLCP(sendToAnalytics);
```
