# Дерево элементов, fiber

- В React два дерева – дерево элементов и fiber.
- В дереве элементов находится UI. В fiber – находится состояние, пропсы, предыдущие состояния и пропсы, которые позволяют хранит дополнительную информацию о компонентах.

Fiber – связанный лист. JS – объект.

```js
const fiberNode = {
  stateNode,
  memoizedProps,
  memoizedState,
  child,
  parent,
  sibling;
}
```

В fiber два типа связи – дочерние и соседские, то есть все элементы знаю о своих родителях и соседях. Самая верхняя node – Host root.

- Первая фаза: «Эффекты»

- Каждый элемент производит “работы” - эффекты (запросы данных, подписки, изменение dom), эффекты тоже лист. Все эффекты они приоритизированы. Они делят на два типа деревьев – current tree, а в том, котором происходят изменения VIP-tree. Таким образом есть 2 процесса rendering и reconciliation.

- Reconciliation можно отменить, так как могли произойти изменения во время более ранних изменений.
  React сравнивает типы элементов и если меняется тип, то элемент и его дочерние элементы демонтируются.
  fiber node мутабельные, dom node – иммутабельные

Вторая фаза «Commit» Здесь выполняются эффекты и меняется дерево элементов, фаза непрерываемая
