# dns

domain name system - На уровне интернет работает с ip, dns позволяет преобразовать ip в читаемый вид
Использует udp на транспортном уровне. работает по модели запрос - ответ. Три элемента инфраструктуры взаимодействия:

- клиент dns
- dns resolver
- кеш
- дерево доменных имен

режимы работы:

- итеративный - если есть ip, то возвращает, если нет возвращает адрес другого dns сервера где ответ есть
- рекурсивный - сервер сам выполняет запросы в другие dns

# Структура строки

дерево доменных имен заложено в поисковую строку

- распределенная система - регистрация ICANN распределяете доменные имена
- делегирование ответственности - разделение
- надежность - серверы задублированы, но данные в открытом виде. Есть защищенные протоколы DNSS, Extension, DoH, Dot

www.site.ru

- ru - заголовок первого уровня, корневой, верхний уровень
- - org
- - ru
- site
- www - имя компьютера

# формат покета

Все данные передается в бинарном виде

- заголовок - 12 байт
- - идентификатор
- - флаги - определяет функционирование использовать рекурсивны или нет, при больших запросах разделит пакет на несколько
- - кол-во запросов
- - кол-во ответов
- - кол-во авторитетных серверов
- - кол-во доп серверов
- запрос dns - для кого хотим получить адрес
- ответы dns
- авторитетные ответы
- доп информация

# запрос

- имя
- тип записи
- класс записи

# ответ

из может быть несколько в одном запросе

виды:

- авторитетный - заслуживающий доверия, то есть получен из dns файла
- неавторитетный - ответ от сервера, который не обслуживает зону или из кеша

Формат:

- имя
- тип записи
- класс
- время жизни
- длина данных
- данные - то есть ip

# запись dns

Можно не только получать ip ресурсов, но и:

- определять адреса IPv4 IPv6
- задавать несколько доменных имен для одного ip
- находить адрес почтового сервера - так как для почты используются отдельные сервера
- задавать адрес dns серверов для доменной зоны
- определять по ip доменное имя

состоит из:

- тип записи - для чего
- - CNAME - определяет псевдоним для другого доменного имени
- - A, AAAA - узнать IPv4 IPv6
- - MX - почтовые
- - NS - какие сервера обслуживают ресурс
- - PTR - обратный запрос ip -> доменное имя
- класс - какая сеть
- тип записи - IPv4 IPv6
