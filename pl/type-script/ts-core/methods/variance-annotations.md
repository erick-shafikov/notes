# вариантность

- in → контравариантный параметр (используется только на вход, как аргумент).
- - Используется только на входе (в аргументах функций, setters).
- - Можно безопасно подставить надтип.
- - Аналогия: «потребитель» (Consumer).

- out → ковариантный параметр (используется только на выход, как результат).
- - Используется только на выходе (в возвращаемых значениях, полях для чтения).
- - Можно безопасно подставить подтип.
- - Аналогия: «производитель» (Producer).

- in out → двухсторонний (invariant), т.е. может использоваться и как вход, и как выход.
- - Тип используется и на вход, и на выход.
- - Подтипы и надтипы подставлять нельзя — нужен именно тот тип.

```ts
interface Box<out T> {
  value: () => T; // T только возвращается => ковариантность
}

interface Consumer<in T> {
  consume: (v: T) => void; // T только на вход => контравариантность
}
```

Без in/out TS по умолчанию делает invariant поведение (строгое). Но с этим синтаксисом авторы библиотеки явно зафиксировали, что типы должны оставаться строгими и не "расслабляться".

```ts
interface Transformer<in out T> {
  get(): T;
  put(value: T): void;
}

let numberTransformer: Transformer<number>;
let anyTransformer: Transformer<any>;

// ❌ Ошибка: нельзя присвоить, даже если number <: any
anyTransformer = numberTransformer;
```
