# ModuleList

Если создать НС с помощью цикла, то слои не будут видны по отдельности. Так как в обучении используется
model.parameters() их не видно, то есть оптимизировать можно будет только внешний единственный слой

Не создает собственной модели

```python
import torch.nn as nn


class DigitNN(nn.Module):
    def __init__(self, input_dim, output_dim, n_layers=3):
        super().__init__()
        self.layers = [
            nn.Linear(
                input_dim // n,  # с каждым шагом производим целочисленное деление
                output_dim // (n + 1)  # уменьшая количеств входных
            ) for n in range(1, n_layers + 1)
        ]

        sz_input = self.layers[-1].out_features
        self.layer_out = nn.Linear(sz_input, output_dim)

    def forward(self, x):
        for layer in self.layers:
            x = layer(x)
            x = nn.functional.tanh(x)

        return self.layer_out(x)

```

решение

```python
import torch.nn as nn


class DigitNN(nn.Module):
    def __init__(self, input_dim, output_dim, n_layers=3):
        super().__init__()
        # каждый слой можно добавить с помощью ModuleList
        self.net = nn.ModuleList(
            nn.Linear(
                input_dim // n,
                output_dim // (n + 1)
            ) for n in range(1, n_layers + 1)
        )

        sz_input = self.layers[-1].out_features
        self.layer_out = nn.Linear(sz_input, output_dim)

    def forward(self, x):
        for layer in self.net:
            x = layer(x)
            x = nn.functional.tanh(x)

        return self.layer_out(x)
```