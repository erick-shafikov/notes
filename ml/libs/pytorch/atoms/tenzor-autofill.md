# Создание и заполнение

```python
import torch

# создание тензоров
# создаст 2 * 3 тензор с нулями
tz_zero = torch.zeros(2, 3, dtype=torch.int32)
# создаст 2 * 3 тензор с единицами
tz_ones = torch.ones(2, 3, dtype=torch.int32)
# создаст 3 * 3 тензор с единицами по главной диагонали
tz_eye = torch.eye(3)
tz_eye2 = torch.eye(3, 2, dtype=torch.int32)  # матрица 3 на 2 с единицами по диагонали
# создать тензор 2 на 4 и заполнить значением 5
tz_full = torch.full((2, 3), 5)
```

# последовательности

```python
import torch

# создание последовательностей
# АП от 0 до 7
range_ap = torch.arange(7)
range_ap2 = torch.arange(-5, 0)  # АП от -5 до 0
range_ap3 = torch.arange(-5, 0, 2)  # с шагом может быть отрицательный
# создаст тензор [1,3,5] начало/старт/шаг
torch.linspace(1, 5, 2)
```

# Создание последовательностей

- torch.rand() - формирует тензор с заданными размерами, состоящий из равномерно распределенных ПСВ в диапазоне [0; 1)
- torch.randn(size, out=None, dtype=None, layout=torch.strided, device=None, requires_grad=False) - формирует тензор с
  заданными размерами, состоящий из нормально распределенных ПСВ с нулевым средним и
  единичной дисперсией
- torch.normal(mean, std, *, generator=None, out=None) - формирует тензор с заданными размерами, состоящий из нормально
  распределенных ПСВ с указанным средним
  и указанной дисперсией
- torch.randint(low, high, size, *, dtype=None, layout=torch.strided, device=None, requires_grad=False) - формирует
  тензор с заданными размерами, состоящий из равномерно распределенных целых ПСВ в заданном диапазоне [a; b)

```python
import torch

# создание произвольных последовательностей
# создание последовательностей с заданным распределением
torch.rand(2, 3)
# размером (21), типом torch.float32, состоящий из равномерно распределенных ПСВ в диапазоне [0; 1);
t1 = torch.rand(21, dtype=torch.float32)
# размером (3, 5), типом torch.int16, состоящий из равномерно распределенных целых ПСВ в диапазоне [-5; 5] (включая обе границы);
t2 = torch.randint(low=-5, high=6, size=(3, 5), dtype=torch.int16)
torch.randn(2, 3)  # нормально распределенные данные с 0 среднем и единичной дисперсией
# размером (64, 128), типом torch.float64, состоящий из нормально распределенных ПСВ с нулевым средним и единичной дисперсией.
t3 = torch.randn(64, 128, dtype=torch.float64)

# задание зерна последовательности
torch.manual_seed(0)

```

# Inplace методы_

Inplace методы меняют содержимое самого тензора, не создавая нового:

- t.random_() - заполнение тензора t равномерно распределенными дискретными ПСВ в диапазоне [a; b)
- t.uniform_() - заполнение тензора t равномерно распределенными непрерывными ПСВ в диапазоне [a; b)
- t.normal_() -заполнение тензора t нормально распределенными ПСВ с указанным средним mean и стандартным отклонением std

```python
import torch

# функции и методы с _ на конце не создают
# ф-ции и методы без _ создают новый
x = torch.FloatTensor(2, 4)
# все четверки поменяет на 1 в x
x.fill_(1)

# заполнить нулями
x0 = torch.FloatTensor(2, 4).zero_()

# преобразования тензора
x.uniform_(1, 7)  # заполнение тензора t равномерно распределенными непрерывными ПСВ в диапазоне [a; b)
x.uniform_(0, 1)  # заполнение тензора равномерно распределенными дискретными ПСВ в диапазоне [a; b)
# размером (3, 10, 2), состоящий из равномерно распределенных непрерывных ПСВ в диапазоне [-2; 10)
t1 = torch.Tensor(3, 10, 2).uniform_(-2, 10)
# заполнение тензора нормально распределенными ПСВ с указанным средним mean и стандартным отклонением st
x.normal_(0, 1)
# размером (123), состоящий из равномерно распределенных целых ПСВ в диапазоне [13; 19] (включая обе границы)
t2 = torch.Tensor(123).random_(13, 20)
# размером (8, 1024), состоящий из нормально распределенных ПСВ со средним 23 (mean=23) и стандартным отклонением 50 (std=50)
t3 = torch.Tensor(8, 1024).normal_(mean=23, std=50)


```

# Представления тензоров

```python
import torch

# представления тензоров
tz27 = torch.arange(27)  # тензор от 0 до 26
tz3_9 = tz27.view(3, 9)  # тензор 3 на 9, используют одинаковые данные
tz3_3_3 = tz27.reshape(3, 3, 3)  # чаще используется view
tz27.resize_(2, 3)  # оставит только 2 на 3, view работает с тем же количеством элементов
# получить одномерный вектор
tz27.ravel()
tz3_9.permute(1, 0)  # поменять оси местами (9 на 3)
tz9_3 = tz3_9.mT  # поменять оси местами (9 на 3)
```

# Добавление и удаление осей

- t.ravel() - возвращает одномерное представление тензора t (вытягивает в вектор)
- t.permute() - создает новое представление тензора t с измененным порядком осей
- t.mT - возвращает транспонированное представление тензора t
- t.unsqueeze() - возвращает новое представление, в котором добавляет новую ось с указанным номером
- t.squeeze() - возвращает новое представление, в котором удаляет указанную ось (либо все оси), если на ней всего один
  элемент

```python
import torch

# добавление
tz_to_squeeze = torch.arange(32).view(8, 2, 2)
# к tz_to_squeeze добавить ось, ны выходе (8, 2, 2) -> (1, 8, 2, 2)
tz_to_squeeze1 = torch.unsqueeze(tz_to_squeeze, dim=0)
# на самом тензоре
tz_to_squeeze.unsqueeze(0)
# или
tz_to_squeeze.unsqueeze_(0)
# добавить в конец
tz_to_squeeze2 = torch.unsqueeze(tz_to_squeeze, dim=-1)
# удаление только те измерения, где один элемент
torch.squeeze(tz_to_squeeze1)

```